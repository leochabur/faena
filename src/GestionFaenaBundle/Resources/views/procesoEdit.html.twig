{% extends "FOSUserBundle::layout.html.twig" %}
        

{% block fos_user_content %}
<br>
<hr>
<span class="h5 card-title">Editar proceso</span>
<hr>

	

	    <p class="h4 mb-4 text-center">{{ proccess.nombre }}</p>
		<div class="row">
		  <div class="col-6">
				<div class="card">
				  <div class="card-header">
				     Reporta articulos a...
				  </div>
				  <div class="card-body">
					<table class="table table-striped table-bordered table-hover table-sm ">
								<thead>
									<tr>
										<th>Proceso Destino</th>
										<th></th>
									</tr>
								</thead>
								<tbody>
					  	{% for send in proccess.procesosDestino %}
					  	  <tr>
								<td>{{ send.nombre }}</td>
						  		<td><a href="{{ path('delete_destination', {origen : proccess.id, destino : send.id}) }}" class="btn btn-sm btn-danger col">Quitar</a></td>
					  	  </tr>
						  
						{% endfor %}	
						</tbody>
						</table>		
						<button type="button" class="btn btn-primary col-6" data-toggle="modal" data-target="#modalSubscriptionForm">Agregar proceso</button>		
				  </div>
				  
				  </div>
				</div>
		
		  <div class="col-6">
				<div class="card">
				  <div class="card-header">
				    Configurar manejo stock
				  </div>
				  <div class="card-body">
						<table class="table table-striped table-bordered table-hover table-sm ">
								<thead>
									<tr>
										<th>Articulo</th>
										<th>Atributo</th>
										<th></th>
									</tr>
								</thead>
								<tbody>
									{% for proceso in proccess.manejosStock %}
										<tr>
											<td>{{ proceso.articulo }}</td>
											<td>{{ proceso.atributo }}</td>
											<td class="text-center"><a href="{{ path('bd_delete_manejo_stock_from_proccess', {proccess : proccess.id, manejo : proceso.id}) }}" class="btn btn-sm btn-danger">Quitar</a></td>
										</tr>
									{% endfor %}
								</tbody>
						</table>
				  	{{ form_start(stock) }}
				  		<div class="form-row align-items-center">
				  			<div class="col">
				  				{{ form_widget(stock.articulo, {'attr' : {'class' : 'form-control-sm'}}) }}
				  			</div>
				  			<div class="col">
				  				{{ form_widget(stock.atributo, {'attr' : {'class' : 'form-control-sm'}}) }}
				  			</div>
				  			<div class="col">
				  				{{ form_widget(stock.asignar, {'attr' : {'class' : 'btn btn-sm btn-success btn-block'}}) }}
				  			</div>
				  		</div>
				  	
				  	{{ form_end(stock) }}
				  </div>
				</div>
			</div>
		</div>


<div class="modal fade" id="modalSubscriptionForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Agregar proceso destino</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
			{{ form_start(form, {'attr': {'class': 'sender'}}) }}
			{{ form_widget(form) }}
			{{ form_end(form) }}
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="viewArticle" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Detalle Articulo</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3 modal-body-article">

      </div>
    </div>
  </div>
</div>
{% endblock fos_user_content %}

{% block javascripts %}

<script type="text/javascript">
	$('.view-art').click(function(){
									var url = "{{ path('bd_view_art_proc_fan', {'articulo' : 'id_article'}) }}"; 
									url = url.replace('id_article', $(this).data('id'));
									$('.modal-body-article').load(url);
									$('#viewArticle').modal('show');
	});

	$('.sender').submit(function (event){
										 event.preventDefault();
										 var form = $(this);
										 $.post(form.attr('action'),
										 		form.serialize(),
										 		function(data){
										 						if (data.status)
										 						{
										 							location.reload();
										 						}
										 						else
										 						{

										 						}


										 		});
										
	});
</script>

{% endblock %}
